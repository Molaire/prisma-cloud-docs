== Traceability and Tagging

Prisma Cloud Application Security supports infrastructure-as-code (IaC) tags to help you trace links between your code and deployed cloud infrastructure. You can add tags to all resource blocks in your repository using https://github.com/bridgecrewio/yor[Yor], an open-source auto-tagging tool that supports Terraform, CloudFormation, and Serverless frameworks. These tags are unique to a repository and resource, and  contain details such as: 

* Git organization, repository, and the exact file containing the IaC template used to create the cloud resource. 
* Timestamp of Git commits for supported cloud resources, including a list of all editors and contributors who modified the file. 
* Custom tags that you create for your resources. Custom tags can be simple key-value pairs or a complex combination of values. For even more complex tagging capabilities, you can leverage Yor CLI/GHA directly. Note that you can edit custom tags on the Prisma Cloud console by adding a tag rule.

=== Yor Trace Tags and Compliance Management

In addition to auto-tags and custom tags, each runtime resource has a unique `yor_trace` tag to trace alerts, detect drift in code and locate the specific resource within a commit. Yor trace tags are accessible in the Prisma Cloud console. 
Yor scans run for every resource. If any resource is not compliant with a tag rule, Yor automatically creates a PR (pull request) for the repository. This PR includes the appropriate tags for each non-compliant resource. You can access your version control system to merge the tag PR and add the tags to the resource. 

NOTE: Only one tag PR can be open per repository at a time. If there is already an open tag PR, Prisma Cloud will not create another.


[.task]

=== Manage Tags

You can manage tags and tag rules for all resources with assigned repositories integrated on Prisma Cloud for governance and monitoring or enforcement of policies for provisioned resources. You can enable, disable, and edit tags for any cloud resource, except auto-generated trace tags (yor_trace) on the Prisma Cloud console.

NOTE: You can replicate an existing tag management strategy through the Prisma Cloud console using tag rules. 

[.procedure]

. Access resource tag management: 
.. In *Application Security > Projects*.
.. Select the *Actions* menu > *Manage IaC Tags*.
+
image::application-security/tags2.1.png[]
+
NOTE: A list of tags will be displayed if Yor has already processed your repositories. This includes yor_trace tags, out-of-the-box tags, and any custom tags that you have defined.

* For both auto-generated tags, out-of-the-box tags and custom tags.
+
** *Enable*
+
Enable a tag to run a scan on all resources in the assigned repositories.
+
image::application-security/tag-3.png[]
+
NOTE: It is a must to assign repositories for a tag before the tag is enabled.
** *Disable*
+
Disable a tag for future resource scans in the repositories. A disabled tag continues to appear on the list of the Prisma Cloud console, and any previous change made using the tag, such as an automated Pull request (PR), will not be reverted.
+
image::application-security/tag-4.png[]

* Only for custom tags.
+
** *Edit*
+
Edit a custom tag for all your resources in the assigned repositories.
+
image::application-security/tag-6.png[]

*** Assign repositories to the tag rule.
+
You can add or remove assigned repositories to the tag. Each assigned repository affects the number of resources. You can monitor the affected resources on the Prisma Cloud console.
+
image::application-security/tag-8.png[]

*** Edit values.
+
You can edit existing values of *Key* and *Value*.

*** Add Conditional Value.
+
You can optionally choose to add or delete conditional values to the tag.
+
image::application-security/tag-7.png[]
+
You must save an edit made to the tag rule and then enable it for Yor to run the scan for all resources.
//** *Clone*
//+
//Clone tag and tag rules for selected repositories.

** *Delete*
+
Delete tags from the Prisma Cloud console. Any previous change made using the tag, such as an automated Pull request (PR) or Clone, will not be reverted.
+
image::application-security/tag-5.png[]

. Add a custom tag rule to resources in assigned repositories.
.. Select *Add Tag Rule*.
+
image::application-security/tag-1.png[]
.. Select repositories to assign the tag rule.
+
image::application-security/tag-9.png[]
+
You can optionally choose to add *Description* for the tag rule.
.. Enter *Key* and *Value*.
+
image::application-security/tag-10.png[]
+
You can optionally choose to *Add Conditional Value* to the tag rule.
+
image::application-security/tag-11.png[]
.. Select *Save* and then select *Done*.
+
Your new custom tag rule appears in the tag list of the Prisma Cloud console.


