== Traceability and Tagging

Traceability tags allows you to locate run time resources that were created based on a specific IaC resource, detect drifts from IaC templates and trace the differences between code and cloud infrastructure. You can add tags to all resource blocks in your repository using https://github.com/bridgecrewio/yor[Yor], an open-source auto-tagging tool that supports Terraform, CloudFormation, and Serverless frameworks. These tags are unique to a repository and resource, and  contain details such as: 

* Git organization, repository, and the exact file containing the IaC template used to create the cloud resource. 
* Timestamp of Git commits for supported cloud resources, including a list of all editors and contributors who modified the file. 
* Custom tags that you create for your resources. Custom tags can be simple key-value pairs or a complex combination of values. For even more complex tagging capabilities, you can leverage Yor CLI/GHA directly. Note that you can edit custom tags on the Prisma Cloud console by adding a tag rule.

=== Yor Trace Tags and Compliance Management

In addition to auto-tags and custom tags, each runtime resource has a unique `yor_trace` tag to trace alerts, detect drift in code and locate the specific resource within a commit. Yor trace tags are accessible in the Prisma Cloud console. 
Yor scans run for every resource. If any resource is not compliant with a tag rule, Yor automatically creates a PR (pull request) for the repository. This PR includes the appropriate tags for each non-compliant resource. You can access your version control system to merge the tag PR and add the tags to the resource. 

NOTE: Only one tag PR can be open per repository at a time. If there is already an open tag PR, Prisma Cloud will not create another.

=== View Tags

To view tags associated with a resource:

. In *Application Security*, select *Projects* > *Group by: Resource*.
. Select a resource.
. View the tags associated with the resource in the *Details* tab of the sidecar.  


[.task]

=== Manage Tags

You can manage tags and tag rules for all resources associated with integrated repositories. This includes custom tags, but excludes auto-generated Yor trace tags (yor_trace). Managing tags includes enabling/disabling and adding conditional values to tags. In addition, you can create, clone or delete custom tag rules. 

//NOTE: You can replicate an existing tag management strategy through the Prisma Cloud console using tag rules. 

[.procedure]

. Access resource tag management: 
.. In *Application Security > Projects*.
.. Select the *Actions* menu > *Manage IaC Tags*.
+
image::application-security/tags2.1.png[]
+
NOTE: A list of tags will be displayed if Yor has already processed your repositories. This includes yor_trace tags, out-of-the-box tags, and any custom tags that you have defined.

. *Enable/Disable* tags: Under the *Actions* menu, select *Play* to enable or *Pause* to disable a tag.
+
image::application-security/tag-enable2.1.png[]
+
NOTE: You can enable or disable all types of tags. Enabling a tag triggers a scan across all resources in the repositories you have assigned to it. Remember to assign repositories before enabling a tag. Disabling a tag prevents future scans from being triggered by the disabled tag. Past actions, such as automated pull requests, will not be reverted.

. *Edit* custom tag rules: 
.. Under the *Actions* menu, select *Edit*.
+
The *Edit a Tag Rule* popup is displayed.
.. Modify values.
* Select the Repositories menu to apply the tag rule to selected repositories or click *Select All Repositories* to apply the tag rule to all your repositories 
+
NOTE: Assigning a repository affects the number of resources. This number is displayed in the popup. You can monitor the affected resources on the Prisma Cloud console.

* (Optional): Add a *Description* for the tag rule.

* Modify the key/value fields as required.

* Click *Add Conditional Value* to add an additional condition to the tag. 

. *Clone* tag rules.
.. Under the *Actions* menu, select *Edit* > *Clone*.
.. Fill in required values in the *Edit a Tag Rule* popup (see above).

. *Delete* tag rules: Under the *Actions* menu, select *Edit* > *Delete*.
+
NOTE: Deleting a tag rule won't affect existing actions triggered by the rule. This includes automated pull requests (PRs) generated for non-compliant resources or any resources that were previously cloned using the deleted tag.

. Select *Save*

. Create *custom tag rules*.
.. In *Projects*, select the *Actions* menu > *Manage IaC Tags*.  
.. Click *Add Tag Rule* in the 'Tag Rules' popup.
.. Assign repositories or all repositories.
.. Add a key/value condition.
+
The created custom tag rule is displayed in the tag list on the Tag Rule popup.


