== Amazon Sagemaker Data Quality Job not encrypting model artifacts with KMS

=== Policy Details

[width=45%]
[cols="1,1"]
|===
|Prisma Cloud Policy ID
| TBD

|Checkov ID
| https://github.com/bridgecrewio/checkov/blob/main/checkov/terraform/checks/resource/aws/SagemakerDataQualityJobDefinitionEncryption.py[CKV_AWS_367]

|Severity
|LOW

|Subtype
|Build

|Frameworks
|Terraform,TerraformPlan,CloudFormation

|===

=== Description

This policy is checking to ensure that Amazon Sagemaker Data Quality Jobs are using Key Management Service (KMS) to encrypt model artifacts. This is important for data security as it prevents unauthorized access to your machine learning models. If these models are not encrypted, sensitive information could potentially be exposed to malicious threats. This could lead to data breaches, compromising the integrity and confidentiality of the data. Hence, it's important to enforce encryption to mitigate such risks.

=== Fix - Buildtime

*Terraform*

* *Resource:* aws_sagemaker_data_quality_job_definition
* *Arguments:* data_quality_job_output_config/kms_key_id

To fix this issue, you need to specify the KMS key to be used for encryption in your AWS SageMaker Data Quality Job resource. You can set this under the `data_quality_job_output_config` block in your Terraform configuration file like below:

[source,go]
----
resource "aws_sagemaker_data_quality_job_definition" "example" {
  ...

  data_quality_job_output_config {
+    kms_key_id = "arn:aws:kms:us-west-2:123456789012:key/my-existing-kms-key-id"
    ...
  }

  ...
}
----


*CloudFormation*

* *Resource:* AWS::SageMaker::DataQualityJobDefinition
* *Arguments:* Properties/DataQualityJobOutputConfig/KmsKeyId

To fix this issue, you need to specify the KMS key to be used for encryption in your AWS SageMaker Data Quality Job resource. You can set this under the `DataQualityJobOutputConfig` block in your CloudFormation configuration file like below:

[source,yaml]
----
...
  AWSTemplateFormatVersion: '2010-09-09'
  ...
  MyDataQualityJobDefinitionPass:
    Type: "AWS::SageMaker::DataQualityJobDefinition"
    Properties:
      ...
      DataQualityJobOutputConfig:
+        KmsKeyId: "arn:aws:kms:us-west-2:123456789012:key/my-existing-kms-key-id"
    ...
----

