== Use of insecure SHA1 hashing algorithm

=== Policy Details

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| 5fa237e7-a850-47be-a42b-2659a705a5e4

|Checkov ID 
|CKV3_SAST_242

|Severity
|LOW

|Subtype
|Build

|Language
|Go

|CWEs
|https://cwe.mitre.org/data/definitions/328.html[CWE-328: Use of Weak Hash]

|OWASP Categories
|https://owasp.org/Top10/A02_2021-Cryptographic_Failures/[A02:2021-Cryptographic Failures]

|=== 

=== Description

This policy identifies the use of the outdated SHA1 hash function from the `crypto/sha1` package in Go applications. SHA1 is considered insecure and should be replaced with more secure hash functions, such as SHA256.

In the following code snippet, the application imports the `crypto/sha1` package and uses SHA1 hashing, which is considered weak and insecure.

[source,Go]
----
package main

import (
    "crypto/sha1"
    "fmt"
)

func main() {
    // Insecure use of SHA1 hashing
    data := []byte("sensitive data")
    hash := sha1.Sum(data)
    fmt.Printf("%x\n", hash)
}
----

=== Fix - Buildtime

To mitigate this issue, use stronger, modern hash functions like SHA256 from the `crypto/sha256` package. SHA256 provides better security due to its resistance to collision attacks.

In this example, the application uses SHA256 hashing instead of SHA1.

[source,Go]
----
package main

import (
    "crypto/sha256"
    "fmt"
)

func main() {
    // Secure use of SHA256 hashing
    data := []byte("sensitive data")
    hash := sha256.Sum256(data)
    fmt.Printf("%x\n", hash)
}
----