== Use of weak DES encryption algorithms

=== Policy Details

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| 35640d3e-f7f7-4289-a97b-a310d4789521

|Checkov ID 
|CKV3_SAST_239

|Severity
|MEDIUM

|Subtype
|Build

|Language
|Go

|CWEs
|https://cwe.mitre.org/data/definitions/327.html[CWE-327: Use of a Broken or Risky Cryptographic Algorithm]

|OWASP Categories
|https://owasp.org/Top10/A02_2021-Cryptographic_Failures/[A02:2021-Cryptographic Failures]

|=== 

=== Description

This policy identifies the use of the DES and Triple DES encryption algorithms from the `crypto/des` package in Go applications. These algorithms are considered weak and insecure due to their small key sizes. It is recommended to use stronger, modern algorithms like AES from the `crypto/aes` package instead.

In the following code snippet, the application imports the `crypto/des` package and uses DES encryption, which is considered weak and insecure.

[source,Go]
----
package main

import (
    "crypto/des"
    "log"
)

func main() {
    // Insecure use of DES encryption
    key := []byte("weakkey")
    _, err := des.NewCipher(key)
    if err != nil {
        log.Fatal(err)
    }
}
----

=== Fix - Buildtime

To mitigate this issue, use stronger, modern encryption algorithms like AES from the `crypto/aes` package. AES provides better security due to its larger key sizes and more robust encryption mechanisms.

In this example, the application uses AES encryption instead of DES.

[source,Go]
----
package main

import (
    "crypto/aes"
    "log"
)

func main() {
    // Secure use of AES encryption
    key := []byte("a very very very very secret key") // 32 bytes for AES-256
    _, err := aes.NewCipher(key)
    if err != nil {
        log.Fatal(err)
    }
}
----